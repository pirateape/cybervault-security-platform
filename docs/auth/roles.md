# Role Model and Permission Matrix\n\n## Role Model\n- Roles are defined per organization in the `org_members` table.\n- Each user can have one of the following roles in an organization:\n - owner\n - admin\n - member\n\n## Permission Matrix\n| Action | Owner | Admin | Member |\n|-----------------------|:-----:|:-----:|:------:|\n| View Org Settings | ✓ | ✓ | |\n| Manage Members | ✓ | ✓ | |\n| Invite Users | ✓ | ✓ | |\n| Remove Users | ✓ | ✓ | |\n| Change Roles | ✓ | ✓ | |\n| Delete Organization | ✓ | | |\n| View Data | ✓ | ✓ | ✓ |\n| Create/Update Data | ✓ | ✓ | ✓ |\n| Delete Data | ✓ | ✓ | |\n\n- All permissions are enforced in the backend (Edge Functions or RLS) and reflected in the frontend UI.\n- The permission matrix can be extended as needed for new actions.\n\n## Usage\n- Use the role context/provider to access the current user's role in the app.\n- Use permission utility functions to check if a user can perform a given action.\n- Always enforce critical permissions in the backend or via RLS.\n\n## Example: Fetching User Roles from Supabase\n\n`typescript\nimport { createClient } from '@supabase/supabase-js';\n\nconst supabase = createClient(process.env.SUPABASE_URL!, process.env.SUPABASE_ANON_KEY!);\n\nexport async function getUserRoles(userId: string) {\n  const { data, error } = await supabase\n    .from('org_members')\n    .select('org_id, role')\n    .eq('user_id', userId);\n  if (error) throw error;\n  return data as Array<{ org_id: string; role: 'owner' | 'admin' | 'member' }>;\n}\n`\n\n## Example: Permission Utility Function\n\n`typescript\nconst permissionMatrix = {\n  'view_org_settings': ['owner', 'admin'],\n  'manage_members': ['owner', 'admin'],\n  'invite_users': ['owner', 'admin'],\n  'remove_users': ['owner', 'admin'],\n  'change_roles': ['owner', 'admin'],\n  'delete_organization': ['owner'],\n  'view_data': ['owner', 'admin', 'member'],\n  'create_update_data': ['owner', 'admin', 'member'],\n  'delete_data': ['owner', 'admin'],\n} as const;\n\ntype Action = keyof typeof permissionMatrix;\n\ntype Role = 'owner' | 'admin' | 'member';\n\nexport function hasPermission(role: Role, action: Action): boolean {\n  return permissionMatrix[action].includes(role);\n}\n`\n\n---
